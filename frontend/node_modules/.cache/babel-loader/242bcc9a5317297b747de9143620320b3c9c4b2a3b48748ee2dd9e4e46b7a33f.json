{"ast":null,"code":"export function getGamesStats(gameData, playerId, playerTeam, playerPosition) {\n  const gameCount = gameData.length;\n  //console.log(\"gameCount: \", gameCount);\n  if (gameCount === 0) {\n    return {}; // Return an empty object if no games are found\n  } else {\n    let gameStats = {\n      playerId: playerId,\n      playerName: \"\",\n      gameTotal: gameCount,\n      winTotal: 0,\n      blueSideTotal: 0,\n      blueSideWinTotal: 0,\n      kda: [0, 0, 0],\n      // [kills, deaths, assists]\n      totalGameDuration: 0,\n      // in seconds\n      firstBloodTotal: 0,\n      // total first bloods taken by the player\n      perfectKDATotal: 0,\n      playedChampionsList: [],\n      winRate: 0,\n      // %\n      blueSidePlayRate: 0,\n      redSidePlayRate: 0,\n      blueSideWinRate: 0,\n      redSideWinRate: 0,\n      averageGameDuration: \"\",\n      // in seconds\n      averageKDA: [],\n      perfectKDARate: 0,\n      damageShare: 0,\n      firstBloodRate: 0,\n      firstTo6Rate: 0,\n      uniqueChampionsCount: 0,\n      uniqueChampionsList: []\n    };\n    let totalDamageShare = 0; // sum of all damage shares\n    for (let i = 0; i < gameCount; i++) {\n      const game = gameData[i];\n\n      // find the player's team\n      const playerTeamNumber = gameData[i].teamBlue == playerTeam ? 0 : 1;\n\n      // count raw stats\n      if (game.winner === (playerTeamNumber === 0)) {\n        gameStats.winTotal += 1;\n        if (game.teamBlue === playerTeam) {\n          gameStats.blueSideTotal += 1;\n          if (game.winner === true) {\n            gameStats.blueSideWinTotal += 1;\n          }\n        }\n      }\n      gameStats.totalGameDuration += game.gameDuration;\n      gameStats.kda[0] += game.kda[playerTeamNumber][playerPosition][0]; // kills\n      gameStats.kda[1] += game.kda[playerTeamNumber][playerPosition][1]; // deaths\n      gameStats.kda[2] += game.kda[playerTeamNumber][playerPosition][2]; // assists\n      if (game.kda[playerTeamNumber][playerPosition][1] === 0) {\n        gameStats.perfectKDATotal += 1;\n      }\n      let teamDamage = 0;\n      for (let j = 0; j < 5; j++) {\n        teamDamage += game.damageDealt[playerTeamNumber][j];\n      }\n      totalDamageShare += game.damageDealt[playerTeamNumber][playerPosition] / teamDamage; // damage share\n      teamDamage = game.damageDealt[playerTeamNumber].reduce((sum, dmg) => sum + dmg, 0);\n      gameStats.playedChampionsList.push(game.champions[playerTeamNumber][playerPosition]);\n    }\n\n    // calulate other stats\n    gameStats.winRate = Number((gameStats.winTotal / gameCount * 100).toFixed(2));\n    gameStats.blueSidePlayRate = Number((gameStats.blueSideTotal / gameCount * 100).toFixed(2));\n    gameStats.redSidePlayRate = Number((100 - gameStats.blueSidePlayRate).toFixed(2));\n    gameStats.blueSideWinRate = gameStats.blueSideTotal === 0 ? 0 : Number((gameStats.blueSideWinTotal / gameStats.blueSideTotal * 100).toFixed(2));\n    gameStats.averageKDA = [Number((gameStats.kda[0] / gameCount).toFixed(2)), Number((gameStats.kda[1] / gameCount).toFixed(2)), Number((gameStats.kda[2] / gameCount).toFixed(2))];\n    gameStats.perfectKDARate = Number((gameStats.perfectKDATotal / gameCount * 100).toFixed(2));\n    gameStats.damageShare = Number((totalDamageShare / gameCount * 100).toFixed(2)); // average damage share per game\n    gameStats.uniqueChampionsList = Array.from(new Set(gameStats.playedChampionsList));\n    gameStats.uniqueChampionsCount = gameStats.uniqueChampionsList.length;\n\n    // calculate average game duration and format it as \"MM:SS\"\n    const averageGameDurationSeconds = gameStats.totalGameDuration / gameCount % 60;\n    const averageGameDurationMinutes = Math.round(gameStats.totalGameDuration / gameCount / 60);\n    gameStats.averageGameDuration = averageGameDurationMinutes.toString() + \":\" + (averageGameDurationSeconds < 10 ? \"0\" : \"\") + averageGameDurationSeconds.toString();\n    //console.log(\"averageGameDuration: \", gameStats.averageGameDuration);\n    return gameStats;\n  }\n}","map":{"version":3,"names":["getGamesStats","gameData","playerId","playerTeam","playerPosition","gameCount","length","gameStats","playerName","gameTotal","winTotal","blueSideTotal","blueSideWinTotal","kda","totalGameDuration","firstBloodTotal","perfectKDATotal","playedChampionsList","winRate","blueSidePlayRate","redSidePlayRate","blueSideWinRate","redSideWinRate","averageGameDuration","averageKDA","perfectKDARate","damageShare","firstBloodRate","firstTo6Rate","uniqueChampionsCount","uniqueChampionsList","totalDamageShare","i","game","playerTeamNumber","teamBlue","winner","gameDuration","teamDamage","j","damageDealt","reduce","sum","dmg","push","champions","Number","toFixed","Array","from","Set","averageGameDurationSeconds","averageGameDurationMinutes","Math","round","toString"],"sources":["C:/Users/loppo/Projets/morestats/frontend/src/utils/calculators/getGamesStats.ts"],"sourcesContent":["import { Game } from \"../../types/Game\";\r\nimport { PlayerGameStats } from \"../../types/PlayerGameStats\";\r\n\r\nexport function getGamesStats(\r\n  gameData: Game[],\r\n  playerId: number,\r\n  playerTeam: string,\r\n  playerPosition: number\r\n): PlayerGameStats {\r\n  const gameCount = gameData.length;\r\n  //console.log(\"gameCount: \", gameCount);\r\n  if (gameCount === 0) {\r\n    return {} as PlayerGameStats; // Return an empty object if no games are found\r\n  } else {\r\n    let gameStats: PlayerGameStats = {\r\n      playerId: playerId,\r\n      playerName: \"\",\r\n\r\n      gameTotal: gameCount,\r\n      winTotal: 0,\r\n      blueSideTotal: 0,\r\n      blueSideWinTotal: 0,\r\n      kda: [0, 0, 0], // [kills, deaths, assists]\r\n      totalGameDuration: 0, // in seconds\r\n      firstBloodTotal: 0, // total first bloods taken by the player\r\n      perfectKDATotal: 0,\r\n      playedChampionsList: [],\r\n\r\n      winRate: 0, // %\r\n      blueSidePlayRate: 0,\r\n      redSidePlayRate: 0,\r\n      blueSideWinRate: 0,\r\n      redSideWinRate: 0,\r\n      averageGameDuration: \"\", // in seconds\r\n      averageKDA: [],\r\n      perfectKDARate: 0,\r\n      damageShare: 0,\r\n      firstBloodRate: 0,\r\n      firstTo6Rate: 0,\r\n      uniqueChampionsCount: 0,\r\n      uniqueChampionsList: [],\r\n    };\r\n    let totalDamageShare = 0; // sum of all damage shares\r\n    for (let i = 0; i < gameCount; i++) {\r\n      const game = gameData[i];\r\n\r\n      // find the player's team\r\n      const playerTeamNumber = gameData[i].teamBlue == playerTeam ? 0 : 1;\r\n\r\n      // count raw stats\r\n      if (game.winner === (playerTeamNumber === 0)) {\r\n        gameStats.winTotal += 1;\r\n        if (game.teamBlue === playerTeam) {\r\n          gameStats.blueSideTotal += 1;\r\n          if (game.winner === true) {\r\n            gameStats.blueSideWinTotal += 1;\r\n          }\r\n        }\r\n      }\r\n      gameStats.totalGameDuration += game.gameDuration;\r\n      gameStats.kda[0] += game.kda[playerTeamNumber][playerPosition][0]; // kills\r\n      gameStats.kda[1] += game.kda[playerTeamNumber][playerPosition][1]; // deaths\r\n      gameStats.kda[2] += game.kda[playerTeamNumber][playerPosition][2]; // assists\r\n      if (game.kda[playerTeamNumber][playerPosition][1] === 0) {\r\n        gameStats.perfectKDATotal += 1;\r\n      }\r\n      let teamDamage = 0;\r\n      for (let j = 0; j < 5; j++) {\r\n        teamDamage += game.damageDealt[playerTeamNumber][j];\r\n      }\r\n      totalDamageShare +=\r\n        game.damageDealt[playerTeamNumber][playerPosition] / teamDamage; // damage share\r\n      teamDamage = game.damageDealt[playerTeamNumber].reduce(\r\n        (sum, dmg) => sum + dmg,\r\n        0\r\n      );\r\n      gameStats.playedChampionsList.push(\r\n        game.champions[playerTeamNumber][playerPosition]\r\n      );\r\n    }\r\n\r\n    // calulate other stats\r\n    gameStats.winRate = Number(\r\n      ((gameStats.winTotal / gameCount) * 100).toFixed(2)\r\n    );\r\n    gameStats.blueSidePlayRate = Number(\r\n      ((gameStats.blueSideTotal / gameCount) * 100).toFixed(2)\r\n    );\r\n    gameStats.redSidePlayRate = Number(\r\n      (100 - gameStats.blueSidePlayRate).toFixed(2)\r\n    );\r\n    gameStats.blueSideWinRate =\r\n      gameStats.blueSideTotal === 0\r\n        ? 0\r\n        : Number(\r\n            (\r\n              (gameStats.blueSideWinTotal / gameStats.blueSideTotal) *\r\n              100\r\n            ).toFixed(2)\r\n          );\r\n    gameStats.averageKDA = [\r\n      Number((gameStats.kda[0] / gameCount).toFixed(2)),\r\n      Number((gameStats.kda[1] / gameCount).toFixed(2)),\r\n      Number((gameStats.kda[2] / gameCount).toFixed(2)),\r\n    ];\r\n    gameStats.perfectKDARate = Number(\r\n      ((gameStats.perfectKDATotal / gameCount) * 100).toFixed(2)\r\n    );\r\n    gameStats.damageShare = Number(\r\n      ((totalDamageShare / gameCount) * 100).toFixed(2)\r\n    ); // average damage share per game\r\n    gameStats.uniqueChampionsList = Array.from(new Set(\r\n      gameStats.playedChampionsList));\r\n    gameStats.uniqueChampionsCount = gameStats.uniqueChampionsList.length;\r\n\r\n    // calculate average game duration and format it as \"MM:SS\"\r\n    const averageGameDurationSeconds =\r\n      (gameStats.totalGameDuration / gameCount) % 60;\r\n    const averageGameDurationMinutes = Math.round(\r\n      gameStats.totalGameDuration / gameCount / 60\r\n    );\r\n    gameStats.averageGameDuration =\r\n      averageGameDurationMinutes.toString() +\r\n      \":\" +\r\n      (averageGameDurationSeconds < 10 ? \"0\" : \"\") +\r\n      averageGameDurationSeconds.toString();\r\n    //console.log(\"averageGameDuration: \", gameStats.averageGameDuration);\r\n    return gameStats;\r\n  }\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}