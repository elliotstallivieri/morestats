{"ast":null,"code":"export function getGamesStats(gameData, playerId, playerTeam, playerPosition) {\n  const gameCount = gameData.length;\n  //console.log(\"gameCount: \", gameCount);\n  if (gameCount === 0) {\n    return {}; // Return an empty object if no games are found\n  } else {\n    let gameStats = {\n      playerId: playerId,\n      playerName: \"\",\n      gameTotal: gameCount,\n      winTotal: 0,\n      blueSideTotal: 0,\n      blueSideWinTotal: 0,\n      kda: [0, 0, 0],\n      // [kills, deaths, assists]\n      totalGameDuration: 0,\n      // in seconds\n      firstBloodTotal: 0,\n      // total first bloods taken by the player\n      perfectKDATotal: 0,\n      winRate: 0,\n      // %\n      blueSidePlayRate: 0,\n      redSidePlayRate: 0,\n      blueSideWinRate: 0,\n      redSideWinRate: 0,\n      averageGameDuration: \"\",\n      // in seconds\n      averageKDA: [],\n      perfectKDARate: 0,\n      damageShare: 0,\n      firstBloodRate: 0,\n      firstTo6Rate: 0\n    };\n    let totalDamageShare = 0; // sum of all damage shares\n    for (let i = 0; i < gameCount; i++) {\n      const game = gameData[i];\n      // find the player's team\n      const playerTeamNumber = gameData[0].teamBlue == playerTeam ? 0 : 1;\n      console.log(\"gameId : \", game.id, \" | winner : \", game.winner, \" | playerTeamNumber: \", playerTeamNumber, \" | playerTeam: \", playerTeam);\n      if (game.winner === (playerTeamNumber === 0)) {\n        gameStats.winTotal += 1;\n        if (game.teamBlue === playerTeam) {\n          gameStats.blueSideTotal += 1;\n          if (game.winner === true) {\n            gameStats.blueSideWinTotal += 1;\n          }\n        }\n      }\n      gameStats.totalGameDuration += game.gameDuration;\n      gameStats.kda[0] += game.kda[playerTeamNumber][playerPosition][0]; // kills\n      gameStats.kda[1] += game.kda[playerTeamNumber][playerPosition][1]; // deaths\n      gameStats.kda[2] += game.kda[playerTeamNumber][playerPosition][2]; // assists\n      if (game.kda[playerTeamNumber][playerPosition][1] === 0) {\n        gameStats.perfectKDATotal += 1;\n      }\n      let teamDamage = 0;\n      for (let j = 0; j < 5; j++) {\n        teamDamage += game.damageDealt[playerTeamNumber][j];\n      }\n      totalDamageShare += game.damageDealt[playerTeamNumber][playerPosition] / teamDamage; // damage share\n      teamDamage = game.damageDealt[playerTeamNumber].reduce((sum, dmg) => sum + dmg, 0);\n    }\n    gameStats.winRate = Number((gameStats.winTotal / gameCount * 100).toFixed(2));\n    gameStats.blueSidePlayRate = Number((gameStats.blueSideTotal / gameCount * 100).toFixed(2));\n    gameStats.redSidePlayRate = Number((100 - gameStats.blueSidePlayRate).toFixed(2));\n    gameStats.blueSideWinRate = gameStats.blueSideTotal === 0 ? 0 : Number((gameStats.blueSideWinTotal / gameStats.blueSideTotal * 100).toFixed(2));\n    gameStats.averageKDA = [Number((gameStats.kda[0] / gameCount).toFixed(2)), Number((gameStats.kda[1] / gameCount).toFixed(2)), Number((gameStats.kda[2] / gameCount).toFixed(2))];\n    gameStats.perfectKDARate = Number((gameStats.perfectKDATotal / gameCount * 100).toFixed(2));\n    gameStats.damageShare = Number((totalDamageShare / gameCount * 100).toFixed(2)); // average damage share per game\n\n    // calculate average game duration and format it as \"MM:SS\"\n    const averageGameDurationSeconds = gameStats.totalGameDuration / gameCount % 60;\n    const averageGameDurationMinutes = Math.round(gameStats.totalGameDuration / gameCount / 60);\n    gameStats.averageGameDuration = averageGameDurationMinutes.toString() + \":\" + (averageGameDurationSeconds < 10 ? \"0\" : \"\") + averageGameDurationSeconds.toString();\n    console.log(\"averageGameDuration: \", gameStats.averageGameDuration);\n    return gameStats;\n  }\n}","map":{"version":3,"names":["getGamesStats","gameData","playerId","playerTeam","playerPosition","gameCount","length","gameStats","playerName","gameTotal","winTotal","blueSideTotal","blueSideWinTotal","kda","totalGameDuration","firstBloodTotal","perfectKDATotal","winRate","blueSidePlayRate","redSidePlayRate","blueSideWinRate","redSideWinRate","averageGameDuration","averageKDA","perfectKDARate","damageShare","firstBloodRate","firstTo6Rate","totalDamageShare","i","game","playerTeamNumber","teamBlue","console","log","id","winner","gameDuration","teamDamage","j","damageDealt","reduce","sum","dmg","Number","toFixed","averageGameDurationSeconds","averageGameDurationMinutes","Math","round","toString"],"sources":["C:/Users/loppo/Projets/morestats/frontend/src/utils/calculators/getGamesStats.ts"],"sourcesContent":["import { Game } from \"../../types/Game\";\r\nimport { PlayerGameStats } from \"../../types/PlayerGameStats\";\r\n\r\nexport function getGamesStats(\r\n  gameData: Game[],\r\n  playerId: number,\r\n  playerTeam: string,\r\n  playerPosition: number\r\n): PlayerGameStats {\r\n  const gameCount = gameData.length;\r\n  //console.log(\"gameCount: \", gameCount);\r\n  if (gameCount === 0) {\r\n    return {} as PlayerGameStats; // Return an empty object if no games are found\r\n  } else {\r\n    let gameStats: PlayerGameStats = {\r\n      playerId: playerId,\r\n      playerName: \"\",\r\n\r\n      gameTotal: gameCount,\r\n      winTotal: 0,\r\n      blueSideTotal: 0,\r\n      blueSideWinTotal: 0,\r\n      kda: [0, 0, 0], // [kills, deaths, assists]\r\n      totalGameDuration: 0, // in seconds\r\n      firstBloodTotal: 0, // total first bloods taken by the player\r\n      perfectKDATotal: 0,\r\n\r\n      winRate: 0, // %\r\n      blueSidePlayRate: 0,\r\n      redSidePlayRate: 0,\r\n      blueSideWinRate: 0,\r\n      redSideWinRate: 0,\r\n      averageGameDuration: \"\", // in seconds\r\n      averageKDA: [],\r\n      perfectKDARate: 0,\r\n      damageShare: 0,\r\n      firstBloodRate: 0,\r\n      firstTo6Rate: 0,\r\n    };\r\n    let totalDamageShare = 0; // sum of all damage shares\r\n    for (let i = 0; i < gameCount; i++) {\r\n      const game = gameData[i];\r\n      // find the player's team\r\n      const playerTeamNumber = gameData[0].teamBlue == playerTeam ? 0 : 1;\r\n      console.log(\r\n        \"gameId : \",\r\n        game.id,\r\n        \" | winner : \",\r\n        game.winner,\r\n        \" | playerTeamNumber: \",\r\n        playerTeamNumber,\r\n        \" | playerTeam: \",\r\n        playerTeam\r\n      );\r\n      if (game.winner === (playerTeamNumber === 0)) {\r\n        gameStats.winTotal += 1;\r\n        if (game.teamBlue === playerTeam) {\r\n          gameStats.blueSideTotal += 1;\r\n          if (game.winner === true) {\r\n            gameStats.blueSideWinTotal += 1;\r\n          }\r\n        }\r\n      }\r\n      gameStats.totalGameDuration += game.gameDuration;\r\n      gameStats.kda[0] += game.kda[playerTeamNumber][playerPosition][0]; // kills\r\n      gameStats.kda[1] += game.kda[playerTeamNumber][playerPosition][1]; // deaths\r\n      gameStats.kda[2] += game.kda[playerTeamNumber][playerPosition][2]; // assists\r\n      if (game.kda[playerTeamNumber][playerPosition][1] === 0) {\r\n        gameStats.perfectKDATotal += 1;\r\n      }\r\n      let teamDamage = 0;\r\n      for (let j = 0; j < 5; j++) {\r\n        teamDamage += game.damageDealt[playerTeamNumber][j];\r\n      }\r\n      totalDamageShare +=\r\n        game.damageDealt[playerTeamNumber][playerPosition] / teamDamage; // damage share\r\n      teamDamage = game.damageDealt[playerTeamNumber].reduce(\r\n        (sum, dmg) => sum + dmg,\r\n        0\r\n      );\r\n    }\r\n\r\n    gameStats.winRate = Number(\r\n      ((gameStats.winTotal / gameCount) * 100).toFixed(2)\r\n    );\r\n    gameStats.blueSidePlayRate = Number(\r\n      ((gameStats.blueSideTotal / gameCount) * 100).toFixed(2)\r\n    );\r\n    gameStats.redSidePlayRate = Number(\r\n      (100 - gameStats.blueSidePlayRate).toFixed(2)\r\n    );\r\n    gameStats.blueSideWinRate =\r\n      gameStats.blueSideTotal === 0\r\n        ? 0\r\n        : Number(\r\n            (\r\n              (gameStats.blueSideWinTotal / gameStats.blueSideTotal) *\r\n              100\r\n            ).toFixed(2)\r\n          );\r\n    gameStats.averageKDA = [\r\n      Number((gameStats.kda[0] / gameCount).toFixed(2)),\r\n      Number((gameStats.kda[1] / gameCount).toFixed(2)),\r\n      Number((gameStats.kda[2] / gameCount).toFixed(2)),\r\n    ];\r\n    gameStats.perfectKDARate = Number(\r\n      ((gameStats.perfectKDATotal / gameCount) * 100).toFixed(2)\r\n    );\r\n    gameStats.damageShare = Number(\r\n      ((totalDamageShare / gameCount) * 100).toFixed(2)\r\n    ); // average damage share per game\r\n\r\n    // calculate average game duration and format it as \"MM:SS\"\r\n    const averageGameDurationSeconds =\r\n      (gameStats.totalGameDuration / gameCount) % 60;\r\n    const averageGameDurationMinutes = Math.round(\r\n      gameStats.totalGameDuration / gameCount / 60\r\n    );\r\n    gameStats.averageGameDuration =\r\n      averageGameDurationMinutes.toString() +\r\n      \":\" +\r\n      (averageGameDurationSeconds < 10 ? \"0\" : \"\") +\r\n      averageGameDurationSeconds.toString();\r\n    console.log(\"averageGameDuration: \", gameStats.averageGameDuration);\r\n    return gameStats;\r\n  }\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}